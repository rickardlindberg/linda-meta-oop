PartCollector #n #last #parts #doneMsg {
  run =
    | "Part" nextPart:x !. -> x
                           -> kill()
  nextPart =
    | isNext #last .:x -> put(add(doneMsg [{parts x}]))
    | isNext .     .:x -> spawn(PartCollector(add(n 1) last add(parts [x]) doneMsg))
  isNext =
    | !(!(#n))
}

StdoutWriter {
  run = "Write" .:x !. -> write(x)
}
